<div class="post">
<h2><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/M9-C8-Cartoon.png"><img alt="" class="aligncenter size-full wp-image-4254" height="400" sizes="(max-width: 600px) 100vw, 600px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/M9-C8-Cartoon.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/M9-C8-Cartoon.png 600w, https://zerodha.com/varsity/wp-content/uploads/2017/06/M9-C8-Cartoon-300x200.png 300w" width="600"/></a></h2>
<h2>8.1 – A tale of 2 stocks</h2>
<p>We have spent a great deal of time and efforts towards understanding risk associated with a portfolio. Our discussion has brought us to a very important stage – it’s time we discuss portfolio optimization. Perhaps, a good start to this discussion would be to understand what portfolio optimization is all about and why it makes sense to optimize a given portfolio.</p>
<p>Before we proceed, let me ask you a question – what do you think is the overall portfolio return, considering a portfolio consists investment in Infosys and Biocon (equally weighted). Assume the expected return of Infosys is 22% and Biocon is 15%.</p>
<p>I know it sounds like a typical MBA class question, but this is an important question and you should know how to answer this question at this stage J</p>
<p>Since the portfolio is equally weighted across two stocks, it implies we invest 50% in Infosys and 50% in Biocon. Given this, the expected portfolio return would be –</p>
<p>= Weight of investment in Infosys <strong>*</strong> Expected return of Infosys <strong>+</strong> Weight of investment in Biocon <strong>*</strong> Expected return of Biocon</p>
<p>Do recall, in the previous chapter we did discuss “Expected Return of a stock” in detail. Anyway, let us work out the answer –</p>
<p>50% * 22% + 50% * 15%</p>
<p>=11% + 7.5%</p>
<p>= <strong>18.5%</strong></p>
<p>So, the portfolio is expected to yield a return of 18.5% annually.</p>
<p>Great, now what if we change the weights? What if invest 30% in Infosys and 70% in Biocon? Or let us say 70% in Infosys and 30% in Biocon?</p>
<p>Let’s figure this out, Case 1 –</p>
<p>30% * 22% + 70% * 15%</p>
<p>= 6.6% + 10.5%</p>
<p><strong>17.1%</strong></p>
<p>Case 2 –</p>
<p>70% * 22% + 30% * 15%</p>
<p>=15.4% + 4.5%</p>
<p>=<strong>19.9%</strong></p>
<p>Needless to say, we can do this for multiple combinations of weights. In fact, here is the table with few of the other combinations possible –</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-1_wt.png"><img alt="" class="aligncenter size-full wp-image-4243" height="200" loading="lazy" sizes="(max-width: 324px) 100vw, 324px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-1_wt.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-1_wt.png 324w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-1_wt-300x185.png 300w" width="324"/></a></p>
<p>As you can notice, as the investment weight varies, the returns also varies. For example if I had decided to invest just 40% in Infy and 60% in Biocon, I’d have enjoyed a return of 17.8%. However, if I had reversed it by investing 60% in Infy and 40% in Biocon, I’d have enjoyed a return of 19.2%, which is an additional 2% return.</p>
<p>This leads us to a super important conclusion – <strong>as the investment weights vary, the returns vary</strong>. In fact, each return has an associated risk profile, so it is prudent to state – as the weights vary, both the risk and return characteristics vary.</p>
<p>Now imagine this – for a given portfolio with ‘n’ number of stocks, wouldn’t it be awesome if you were to look at the past data and intelligently identify how much to invest in each stock, so that the portfolio yields the best possible returns?</p>
<p>This is exactly what happens when you optimize your portfolio. Generally speaking, you can adjust the weights (or optimize your portfolio) such that, for the given set of stocks –</p>
<ul>
<li>You identify the investment weights to achieve the best possible return or</li>
<li>You identify the investment weights to achieve the least possible risk</li>
</ul>
<p>Sounds confusing? Fear not, just read ahead!</p>
<h2>8.2 – Caution! Jargons ahead</h2>
<p>Hopefully by now, you fully appreciate the reason why one should optimize the portfolio. So, I won’t spend more time convincing you ☺</p>
<p>Let us go ahead and optimize the portfolio we have been working with. However, there are few important terms I want you to be familiar with at this stage –</p>
<p><strong>Minimum variance portfolio</strong> – Assume you have a portfolio of 10 stocks. It must be quite obvious by now that you can play around with the weights of each stock to achieve different results. When I say results, I’m talking about the risk and return characteristics.&nbsp; Each unique set of weights represents a unique portfolio. For example an equally weighted portfolio (10 stocks, 10% weight in each) is a unique portfolio. A portfolio where you invest 30% in stock 1 and 7.8% each across the remaining 9 stocks is another unique portfolio. The number of combination possible are many and each combination of weights results in a unique risk and return characteristics.</p>
<p>Given this, there should be that one set of combination of stock weights possible, such that the risk for the portfolio is the least possible. More technically, there should be combination of weights possible such that the variance of the portfolio is minimum. This particular portfolio is also referred to as the “Minimum Variance Portfolio”. The minimum variance portfolio represents the least amount of risk you can take. So if you are a highly risk averse investor, you should aim to create a minimum variance portfolio.</p>
<p><strong>Maximum Return portfolio</strong> – This is somewhat the opposite of a minimum variance portfolio. Just like a minimum variance portfolio, there should be a combination of weights such that we can achieve a portfolio with maximum return possible. This also means that for a maximum return portfolio, the risk too will be on the higher side.</p>
<p><strong>Fixed variance, multiple portfolios – </strong>This is not really a jargon, but a concept that you need to be aware of at this stage. It may come across as a little confusing at this point, but I’m certain, later on in this chapter (or maybe next) you will understand this much better, especially when we perform portfolio optimization.</p>
<p>For a given level of risk or variance of a portfolio, you can create <strong>at least two</strong> unique portfolios. One of such portfolio will yield the highest possible return and the other portfolio will yield the lowest return for the same given level of risk.</p>
<p>Here is an example on a completely arbitrary basis – let us say the risk or variance of a portfolio is 15%, given this, there will be a portfolio which can yield 30% return (highest possible return) and another portfolio which can yield 12% return (lowest possible return). &nbsp;Do note, for both these portfolios, the risk is fixed to 15% but the returns vary.</p>
<p>Between these two portfolios there could be multiple other (unique) portfolios with varying return profile.&nbsp; &nbsp;In super simple terms – for a fixed amount of risk, there could be multiple portfolio combinations, and within these possible combinations, there will be a portfolio with maximum return and another with minimum return.</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Risk-Return-diagram.png"><img alt="" class="aligncenter size-full wp-image-4255" height="400" loading="lazy" sizes="(max-width: 600px) 100vw, 600px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Risk-Return-diagram.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Risk-Return-diagram.png 600w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Risk-Return-diagram-300x200.png 300w" width="600"/></a></p>
<p>We will revisit this concept a little later in the chapter, but for now, just keep this thought at the back of your mind.</p>
<h2>8.3 – Portfolio optimization (steps)</h2>
<p>Let us recall the portfolio that we have – the stock names and the associated weights are as follows. Do note, this is a continuation of the portfolio we have been working with over the previous few chapters.</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-2_port.png"><img alt="" class="aligncenter size-full wp-image-4244" height="181" loading="lazy" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-2_port.png" width="278"/></a></p>
<p>Do remember, the weights assigned are all random, there was no thought process to it. For this portfolio with these combination of weights, the annual portfolio variance was estimated at <strong>17.64% </strong>and expected return as <strong>55.14%. </strong></p>
<p>Our objective now is to optimize this portfolio to achieve a desired outcome. To optimize a portfolio in excel, we need the ‘Solver Tool’ in excel. You will find the solver tool under the ‘Data ribbon’.<a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-3_sol.png"><img alt="" class="aligncenter wp-image-4245" height="223" loading="lazy" sizes="(max-width: 800px) 100vw, 800px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-3_sol.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-3_sol.png 1464w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-3_sol-300x84.png 300w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-3_sol-768x214.png 768w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-3_sol-1024x285.png 1024w" width="800"/></a></p>
<p>Many of you may not find the ‘solver’ tool under the data ribbon. This is because you’ve not added it from the excel add ins. To add solver, follow these simple steps –</p>
<ol>
<li>Click on Files on the opened excel sheet</li>
<li>Select Options</li>
<li>Select Add-ins (last but one option)</li>
<li>Click on ‘Solver Add Ins’</li>
<li>Click on “Go”</li>
<li>Check on “Solved Add ins” once again</li>
<li>Click Ok and close</li>
<li>Close the excel sheet, if required restart your system</li>
<li>Check under data ribbon – you should be able to find the solver tool</li>
</ol>
<p>To begin with, let us optimize the portfolio to get the “Minimum Variance portfolio”. Here are few simple steps that you can follow to achieve this.</p>
<p><strong>Step 1</strong> – Organize your data. This is the key to using solver. Your cells should be linked, data should be neatly organized. No hard coding of data. Here is how the data on excel sheet looks at this stage.</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-4_organize.png"><img alt="" class="aligncenter size-full wp-image-4246" height="629" loading="lazy" sizes="(max-width: 617px) 100vw, 617px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-4_organize.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-4_organize.png 617w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-4_organize-294x300.png 294w" width="617"/></a></p>
<p>I’ve highlight two important parts, which we will use for optimizing. The top most part has the weights assigned to each stock. Needless to say, this will change once the portfolio is optimized. The 2<sup>nd</sup> part has the expected return and annual portfolio variance calculation, which will also change when we optimize the portfolio.</p>
<p><strong>Step 2</strong> – Use the solver tool in excel to optimize the weights. I’m assuming you may be new to solver, hence will give you a quick overview of this tool. You can use solver to work with something called as an ‘objective’. An objective, according to solver is essentially a data point, derived by set of formulas. You can minimize the objective’s value or maximize the objective’s value or set the value of an objective to a certain desired value. You can do this while changing certain variables. The variables, according to solver are the elements of the formulas used in deriving the objective.&nbsp; For example, I can choose to minimize the variance of the portfolio by changing the weights of each stock. Here, the variance is the objective and the weights are the variable.</p>
<p>When we command the solver to minimize the objective (variance in this case), then in the background, excel’s solver will quickly check the formulas used and works around it in such a way that the objective’s value is least minimum.</p>
<p>Look at the image below, I’m invoking the solver tool and will soon ask it to minimize the variance.</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-5_invok-solver.png"><img alt="" class="aligncenter wp-image-4247" height="394" loading="lazy" sizes="(max-width: 800px) 100vw, 800px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-5_invok-solver.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-5_invok-solver.png 1375w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-5_invok-solver-300x148.png 300w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-5_invok-solver-768x379.png 768w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-5_invok-solver-1024x505.png 1024w" width="800"/></a></p>
<p>When you click on the data ribbon and click on solver, you will see the solver tool open up, as seen above. We need to set the objective here. Objective as I mentioned earlier, is the annual portfolio variance. Remember, we are working towards finding the minimum variance portfolio here.</p>
<p>Check the image below –</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-6_port-var.png"><img alt="" class="aligncenter wp-image-4248" height="399" loading="lazy" sizes="(max-width: 800px) 100vw, 800px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-6_port-var.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-6_port-var.png 1370w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-6_port-var-300x150.png 300w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-6_port-var-768x383.png 768w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-6_port-var-1024x511.png 1024w" width="800"/></a></p>
<p>Objective is set to ‘Annual portfolio variance’ – you can notice the cell address is highlighted in the ‘set objective’ field. The cell containing the annual portfolio variance itself is highlighted below, you will find another red arrow here. We are minimizing the objective here, the same is highlighted by the green arrow.</p>
<p>Once this is set, the next step is to inform the solver tool that we need minimize the objective by changing the variables. In this case, the variable happens to be the weights assigned to each stock.</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-7_change-var.png"><img alt="" class="aligncenter wp-image-4249" height="351" loading="lazy" sizes="(max-width: 800px) 100vw, 800px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-7_change-var.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-7_change-var.png 1504w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-7_change-var-300x131.png 300w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-7_change-var-768x337.png 768w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-7_change-var-1024x449.png 1024w" width="800"/></a></p>
<p>As you can see, in the “By changing variable cells” field, I’ve highlighted the weights assigned to each stocks.</p>
<p>You can also find “subject to constraints”, field. This essentially means, that solver will minimize the variance, by change the weights of each stock, and at this stage, it is also asking us if there are any constraints it needs to keep in mind while solving to minimize the variance.</p>
<p>One constraint that I can think of at this stage is that the total weight of all stocks put together should be 100%. This essentially means that my capital is 100% deployed across all the 5 stocks. If I do not specific this, then there is a chance that solver may suggest to skip investments across few stock altogether. Remember, solver is an excel tool, and it does not appreciate stock picking</p>
<p>To add a constraint, click on ‘add’. When you do so the following window opens up –</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-8_constraint.png"><img alt="" class="aligncenter size-full wp-image-4250" height="246" loading="lazy" sizes="(max-width: 588px) 100vw, 588px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-8_constraint.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-8_constraint.png 588w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-8_constraint-300x126.png 300w" width="588"/></a></p>
<p>Under Cell reference, I will give the sum of weights of stocks – which needs to be equal to 100%. Next to this, you can see a drop down menu with multiple options, I’d pick ‘=’ here. Finally, the constraint itself will be 100%. Note, I’ve typed out 100% here.</p>
<p>In simple words, I’m asking solver to optimize for minimum variance, keeping the weight of all stock to 100%. The window now looks like this –</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-9_add-constr.png"><img alt="" class="aligncenter wp-image-4251" height="168" loading="lazy" sizes="(max-width: 800px) 100vw, 800px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-9_add-constr.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-9_add-constr.png 1057w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-9_add-constr-300x63.png 300w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-9_add-constr-768x161.png 768w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-9_add-constr-1024x215.png 1024w" width="800"/></a></p>
<p>The solver is completely set up now. The final screen before pressing “Solve” looks like this –</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-10_solver.png"><img alt="" class="aligncenter wp-image-4252" height="474" loading="lazy" sizes="(max-width: 800px) 100vw, 800px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-10_solver.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-10_solver.png 1220w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-10_solver-300x178.png 300w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-10_solver-768x455.png 768w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-10_solver-1024x607.png 1024w" width="800"/></a></p>
<p>I’ve highlighted the weights of each stock for reference. Remember, these are pre optimized weights that we randomly assigned at the beginning of this discussion. Post optimizing, the weights will be changed such that the variance is least possible for these set of stocks. Let us go ahead and press ‘solve’ and check what solver has for us.</p>
<p>And here you go –</p>
<p><a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-11_solved.png"><img alt="" class="aligncenter size-full wp-image-4253" height="291" loading="lazy" sizes="(max-width: 546px) 100vw, 546px" src="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-11_solved.png" srcset="https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-11_solved.png 546w, https://zerodha.com/varsity/wp-content/uploads/2017/06/Image-11_solved-300x160.png 300w" width="546"/></a></p>
<p>Solver has solved for the ‘minimum variance’ portfolio and accordingly it has worked out the weights for each stock.</p>
<p>For example, it wants us to increase the weight in Cipla from current 7% to 29.58%, while it wants us to reduce the weight in Idea to 5.22% from 16%. So on and so forth. Further, it is also telling us that the least possible variance with this portfolio is <strong>15.57%</strong> (remember, the variance was earlier at 17.64%). &nbsp;Along with this, the portfolio’s expected return too seem to have dropped to <strong>36.25%</strong> from the earlier 55.14%.</p>
<p>So, no matter what you do, the variance cannot be lowered below 15.57%. In other words, if these are the 5 stocks that you want to invest in, then the least amount of risk you will be exposed to is 15.57% and absolutely nothing below that!</p>
<p>I’ll leave you at this. In the next chapter, we will optimize the same portfolio for few more scenarios and work towards building something called as an ‘Efficient Frontier’.</p>
<p>You can <a href="https://zerodha.com/varsity/wp-content/uploads/2017/06/Chapter-8_Min-var-port.xlsx"><strong>download</strong></a> the excel sheet used in this chapter.&nbsp;Do note, the excel contains the optimized weights for the minimum variance portfolio.</p>
<hr/>
<h3>Key takeaways from this chapter</h3>
<ol>
<li>The returns of the portfolio is dependent on the weights assigned to each stock</li>
<li>Minimum variance portfolio is that portfolio where the variance or risk is least possible for the given set of stocks</li>
<li>Maximum return portfolio is that portfolio where the expected portfolio returns are maximized for the given set of stocks</li>
<li>When we fix the variance of a portfolio we can achieve at least two portfolios where the expected portfolio returns can be maximum or least</li>
<li>One can optimize a given portfolio with ‘n’ number of stocks on excel, by using the solver tool</li>
<li>One of the most important points to remember while using solver is to ensure the data is well organized. One can do this by linking all the relevant cells and avoiding hard coding of values</li>
<li>You can optimize the portfolio by subjecting the variable to constrains</li>
</ol>
<div class="clear"> </div>
</div>